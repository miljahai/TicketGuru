{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/sirvi/Documents/IT-tradenomikoulutus/OhjelmistoProjektiI/TicketGuru/ticketguruclient/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/sirvi/Documents/IT-tradenomikoulutus/OhjelmistoProjektiI/TicketGuru/ticketguruclient/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/sirvi/Documents/IT-tradenomikoulutus/OhjelmistoProjektiI/TicketGuru/ticketguruclient/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Box,Typography,Container,Button,IconButton,Dialog,DialogTitle,DialogActions,DialogContent}from\"@mui/material\";import{ConfirmationNumber}from'@mui/icons-material';import{useEffect,useState}from\"react\";import{useUser}from'../util/UserProvider';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ShowTicket(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var code=props.ticket.code;var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),qrCode=_useState4[0],setQRCode=_useState4[1];var user=useUser();var dayjs=require('dayjs');var handleClickOpen=function handleClickOpen(){setOpen(true);};var handleClose=function handleClose(){setOpen(false);};useEffect(function(){function fetchQRCode(){return _fetchQRCode.apply(this,arguments);}function _fetchQRCode(){_fetchQRCode=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,blob,url;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"http://localhost:8080/qrcode/\".concat(code),{headers:{'Authorization':\"Bearer \".concat(user.jwt)}});case 2:response=_context.sent;_context.next=5;return response.blob();case 5:blob=_context.sent;url=URL.createObjectURL(blob);setQRCode(url);case 8:case\"end\":return _context.stop();}},_callee);}));return _fetchQRCode.apply(this,arguments);}fetchQRCode();},[code,user.jwt]);var printTicket=function printTicket(){var printHeader=document.getElementById(\"ticket-dialog-title\").innerHTML;var printContents=document.getElementById(\"ticket-dialog\").innerHTML;// Create a new window object and set its content asynchronously\nvar newWindow=window.open();newWindow.document.write('<html><head><title>TicketGuru</title></head><body><footer></footer>');newWindow.document.write(printHeader+'<br>'+printContents);newWindow.document.write('</body></html>');newWindow.document.close();// Wait for the content to load before triggering the print dialog\nnewWindow.onload=function(){newWindow.print();newWindow.close();};};return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(IconButton,{onClick:handleClickOpen,children:/*#__PURE__*/_jsx(ConfirmationNumber,{})}),/*#__PURE__*/_jsxs(Dialog,{open:open,onClose:handleClose,children:[/*#__PURE__*/_jsxs(DialogTitle,{id:\"ticket-dialog-title\",className:\"footer hide-on-print\",children:[\"TicketGuru Lippu #\",props.ticket.ticket_id]}),/*#__PURE__*/_jsxs(DialogContent,{id:\"ticket-dialog\",className:\"footer hide-on-print\",children:[/*#__PURE__*/_jsx(Typography,{variant:\"caption\",children:props.ticket.code}),/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(Box,{component:\"img\",src:qrCode,alt:props.ticket.code})}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",mt:4,children:props.ticket.ticketType.eventRecord.eventrecord_name}),/*#__PURE__*/_jsxs(Typography,{children:[props.ticket.ticketType.eventRecord.venue,\", \",props.ticket.ticketType.eventRecord.city]}),/*#__PURE__*/_jsxs(Typography,{variant:\"h5\",children:[dayjs(props.ticket.ticketType.eventRecord.event_starttime).format('DD.MM.YYYY HH:MM'),\" - \",dayjs(props.ticket.ticketType.eventRecord.event_endtime).format('DD.MM.YYYY HH:MM')]}),/*#__PURE__*/_jsx(Typography,{mb:4,variant:\"h5\",children:props.ticket.ticketType.name}),/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",children:[\"Myyntiaika: \",dayjs(props.ticket.salesEvent.sale_date).format('DD.MM.YYYY HH:MM'),\" (id: \",props.ticket.salesEvent.salesevent_id,\")\"]})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:printTicket,children:\"Tulosta lippu\"}),/*#__PURE__*/_jsx(Button,{onClick:handleClose,children:\"Sulje\"})]})]})]});}","map":{"version":3,"names":["Box","Typography","Container","Button","IconButton","Dialog","DialogTitle","DialogActions","DialogContent","ConfirmationNumber","useEffect","useState","useUser","jsx","_jsx","jsxs","_jsxs","ShowTicket","props","_useState","_useState2","_slicedToArray","open","setOpen","code","ticket","_useState3","_useState4","qrCode","setQRCode","user","dayjs","require","handleClickOpen","handleClose","fetchQRCode","_fetchQRCode","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","blob","url","wrap","_callee$","_context","prev","next","fetch","concat","headers","jwt","sent","URL","createObjectURL","stop","printTicket","printHeader","document","getElementById","innerHTML","printContents","newWindow","window","write","close","onload","print","children","onClick","onClose","id","className","ticket_id","variant","component","src","alt","mt","ticketType","eventRecord","eventrecord_name","venue","city","event_starttime","format","event_endtime","mb","name","salesEvent","sale_date","salesevent_id"],"sources":["C:/Users/sirvi/Documents/IT-tradenomikoulutus/OhjelmistoProjektiI/TicketGuru/ticketguruclient/src/components/ShowTicket.js"],"sourcesContent":["import { Box, Typography, Container, Button, IconButton, Dialog, DialogTitle, DialogActions, DialogContent } from \"@mui/material\";\r\nimport { ConfirmationNumber, } from '@mui/icons-material';\r\nimport { useEffect, useState } from \"react\";\r\nimport { useUser } from '../util/UserProvider';\r\n\r\nexport default function ShowTicket(props) {\r\n    const [open, setOpen] = useState(false);\r\n    const code = props.ticket.code;\r\n    const [qrCode, setQRCode] = useState(null);\r\n    const user = useUser();\r\n    const dayjs = require('dayjs')\r\n\r\n    const handleClickOpen = () => {\r\n        setOpen(true);\r\n    };\r\n    const handleClose = () => {\r\n        setOpen(false);\r\n    };\r\n\r\n    useEffect(() => {\r\n\r\n        async function fetchQRCode() {\r\n            const response = await fetch(`http://localhost:8080/qrcode/${code}`, {\r\n                headers: {\r\n                    'Authorization': `Bearer ${user.jwt}`\r\n                },\r\n            });\r\n            const blob = await response.blob();\r\n            const url = URL.createObjectURL(blob);\r\n            setQRCode(url);\r\n        }\r\n        fetchQRCode();\r\n    }, [code, user.jwt]);\r\n\r\n    const printTicket = () => {\r\n        const printHeader = document.getElementById(\"ticket-dialog-title\").innerHTML;\r\n        const printContents = document.getElementById(\"ticket-dialog\").innerHTML;\r\n\r\n        // Create a new window object and set its content asynchronously\r\n        const newWindow = window.open();\r\n        newWindow.document.write('<html><head><title>TicketGuru</title></head><body><footer></footer>');\r\n        newWindow.document.write(printHeader + '<br>' + printContents);\r\n        newWindow.document.write('</body></html>');\r\n        newWindow.document.close();\r\n\r\n        // Wait for the content to load before triggering the print dialog\r\n        newWindow.onload = () => {\r\n            newWindow.print();\r\n            newWindow.close();\r\n        }\r\n    };\r\n\r\n\r\n    return (\r\n        <Container>\r\n            <IconButton onClick={handleClickOpen}><ConfirmationNumber /></IconButton>\r\n            <Dialog open={open} onClose={handleClose}>\r\n                <DialogTitle id='ticket-dialog-title' className=\"footer hide-on-print\">TicketGuru Lippu #{props.ticket.ticket_id}</DialogTitle>\r\n                <DialogContent id='ticket-dialog' className=\"footer hide-on-print\">\r\n                    <Typography variant='caption'>{props.ticket.code}</Typography>\r\n                    <Container>\r\n                        <Box component='img' src={qrCode} alt={props.ticket.code} />\r\n                    </Container>\r\n                    <Typography variant='h4' mt={4}>{props.ticket.ticketType.eventRecord.eventrecord_name}</Typography>\r\n                    <Typography>{props.ticket.ticketType.eventRecord.venue}, {props.ticket.ticketType.eventRecord.city}</Typography>\r\n                    <Typography variant='h5'>{dayjs(props.ticket.ticketType.eventRecord.event_starttime).format('DD.MM.YYYY HH:MM')} - {dayjs(props.ticket.ticketType.eventRecord.event_endtime).format('DD.MM.YYYY HH:MM')}</Typography>\r\n                    <Typography mb={4} variant='h5' >{props.ticket.ticketType.name}</Typography>\r\n                    <Typography variant='caption'>Myyntiaika: {dayjs(props.ticket.salesEvent.sale_date).format('DD.MM.YYYY HH:MM')} (id: {props.ticket.salesEvent.salesevent_id})</Typography>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={printTicket}>Tulosta lippu</Button>\r\n                    <Button onClick={handleClose}>Sulje</Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n        </Container>\r\n    )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}