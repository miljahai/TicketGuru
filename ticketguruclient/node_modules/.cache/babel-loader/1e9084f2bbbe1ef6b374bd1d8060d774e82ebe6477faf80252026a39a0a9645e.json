{"ast":null,"code":"import _slicedToArray from\"C:/Users/sirvi/Documents/IT-tradenomikoulutus/OhjelmistoProjektiI/TicketGuru/ticketguruclient/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import{Box,Typography,AppBar,Toolbar,Container}from\"@mui/material\";import Sivupalkki from\"../components/Sivupalkki\";import{Link,Outlet}from\"react-router-dom\";import{useUser}from'../util/UserProvider';import jwt_decode from\"jwt-decode\";import axios from\"axios\";import Reports from'../components/Reports';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Raportit(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),tickets=_useState2[0],setTickets=_useState2[1];var user=useUser();var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),roles=_useState4[0],setRoles=_useState4[1];useEffect(function(){Promise.all([axios.get('http://localhost:8080/tickets',{headers:{'Authorization':\"Bearer \".concat(user.jwt)}})]).then(function(_ref){var _ref2=_slicedToArray(_ref,1),res=_ref2[0];console.log('Tickets fetched:',res.data);var data=res.data;setTickets(data);}).catch(function(error){console.log('Error fetching TicketTypes: ',error);});},[user.jwt]);useEffect(function(){if(user&&user.jwt){var decodedJwt=jwt_decode(user.jwt);setRoles(decodedJwt.authorities);}},[user,user.jwt]);return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(Box,{component:\"span\",sx:{p:2},children:[/*#__PURE__*/_jsx(AppBar,{position:\"static\",sx:{borderRadius:'15px 50px'},children:/*#__PURE__*/_jsxs(Toolbar,{children:[/*#__PURE__*/_jsx(Sivupalkki,{}),/*#__PURE__*/_jsx(Typography,{component:Link,to:\"/\",sx:{flexGrow:1,textAlign:'center'},variant:\"h1\",children:\"TicketGuru\"})]})}),/*#__PURE__*/_jsx(Outlet,{}),/*#__PURE__*/_jsx(Typography,{variant:\"h2\",sx:{p:2,flexGrow:1,textAlign:'center'},children:\"Raportit\"}),roles&&roles.filter(function(role){return role===\"ADMIN\"||role===\"EVENT\";}).length>0?/*#__PURE__*/_jsx(Reports,{tickets:tickets}):/*#__PURE__*/_jsx(_Fragment,{})]})});}export default Raportit;","map":{"version":3,"names":["useState","useEffect","Box","Typography","AppBar","Toolbar","Container","Sivupalkki","Link","Outlet","useUser","jwt_decode","axios","Reports","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Raportit","_useState","_useState2","_slicedToArray","tickets","setTickets","user","_useState3","_useState4","roles","setRoles","Promise","all","get","headers","concat","jwt","then","_ref","_ref2","res","console","log","data","catch","error","decodedJwt","authorities","children","component","sx","p","position","borderRadius","to","flexGrow","textAlign","variant","filter","role","length"],"sources":["C:/Users/sirvi/Documents/IT-tradenomikoulutus/OhjelmistoProjektiI/TicketGuru/ticketguruclient/src/pages/Raportit.js"],"sourcesContent":["import { useState, useEffect} from 'react'\r\nimport { Box, Typography, AppBar, Toolbar, Container } from \"@mui/material\";\r\nimport Sivupalkki from \"../components/Sivupalkki\";\r\nimport { Link, Outlet } from \"react-router-dom\";\r\nimport { useUser } from '../util/UserProvider'\r\nimport jwt_decode from \"jwt-decode\";\r\nimport axios from \"axios\";\r\nimport Reports from '../components/Reports'\r\n\r\n\r\n\r\nfunction Raportit() {\r\n\r\n    const [tickets, setTickets] = useState([])\r\n    const user = useUser();\r\n    const [roles, setRoles] = useState([]);\r\n\r\n    useEffect(() => {\r\n        Promise.all([\r\n            axios.get('http://localhost:8080/tickets', {\r\n                headers: {\r\n                    'Authorization': `Bearer ${user.jwt}`\r\n                }\r\n            })\r\n        ]).then(([res]) => {\r\n            console.log('Tickets fetched:', res.data);\r\n            const data = res.data\r\n            setTickets(data);\r\n        }).catch(error => {\r\n            console.log('Error fetching TicketTypes: ', error);\r\n        });\r\n    }, [user.jwt]);\r\n\r\n    useEffect(() => {\r\n        if (user && user.jwt) {\r\n            const decodedJwt = jwt_decode(user.jwt);\r\n            setRoles(decodedJwt.authorities);\r\n        }\r\n    }, [user, user.jwt]);\r\n\r\n    return (\r\n        <Container>\r\n            <Box component=\"span\" sx={{ p: 2 }}>\r\n                <AppBar position='static' sx={{ borderRadius: '15px 50px' }}>\r\n                    <Toolbar>\r\n                        {<Sivupalkki />}\r\n                        <Typography component={Link} to=\"/\" sx={{ flexGrow: 1, textAlign: 'center' }} variant=\"h1\">TicketGuru</Typography>\r\n                    </Toolbar>\r\n                </AppBar>\r\n                <Outlet />\r\n                <Typography variant=\"h2\" sx={{ p: 2, flexGrow: 1, textAlign: 'center' }}>Raportit</Typography>\r\n                {roles && roles.filter((role) => role === \"ADMIN\" || role === \"EVENT\").length > 0 ? (\r\n                    <Reports tickets={tickets} />\r\n                    \r\n                ) : (\r\n                    <></>      \r\n                )}\r\n            </Box>\r\n        </Container>\r\n    )\r\n}\r\n\r\nexport default Raportit;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}