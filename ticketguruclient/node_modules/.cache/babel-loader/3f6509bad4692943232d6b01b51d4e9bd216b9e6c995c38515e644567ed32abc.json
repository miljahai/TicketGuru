{"ast":null,"code":"import _slicedToArray from\"C:/Users/sirvi/Documents/IT-tradenomikoulutus/OhjelmistoProjektiI/TicketGuru/ticketguruclient/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import{Box,Typography,AppBar,Toolbar,Container}from\"@mui/material\";import Sivupalkki from\"../components/Sivupalkki\";import{Link,Outlet,useNavigate}from\"react-router-dom\";import Avatar from'@mui/material/Avatar';import Button from'@mui/material/Button';import TextField from'@mui/material/TextField';import LockOutlinedIcon from'@mui/icons-material/LockOutlined';import{useUser}from'../util/UserProvider';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(){var user=useUser();var navigate=useNavigate();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];// Redirect to home page if user is already logged in\nuseEffect(function(){if(user.jwt)navigate(\"/\");},[user,navigate]);// Send login request\nvar sendLoginRequest=function sendLoginRequest(event){event.preventDefault();var reqBody={email:email,password:password};// Get JWT token from server\nfetch(\"http://localhost:8080/auth/login\",{headers:{\"Content-Type\":\"application/json\"},method:\"POST\",body:JSON.stringify(reqBody)}).then(function(response){if(response.status===200)return Promise.all([response.json(),response.headers]);else if(response.status===401||response.status===403){return Promise.reject(\"Invalid email or password\");}else{return Promise.reject(\"Something went wrong\");}}).then(function(_ref){var _ref2=_slicedToArray(_ref,2),body=_ref2[0],headers=_ref2[1];// Save JWT token and user info to context\nuser.setJwt(headers.get(\"Authorization\"));user.setUserInfo(body);}).catch(function(message){alert(message);});};return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(Box,{component:\"span\",sx:{p:2},children:[/*#__PURE__*/_jsx(AppBar,{position:\"static\",sx:{borderRadius:'15px 50px'},children:/*#__PURE__*/_jsxs(Toolbar,{children:[/*#__PURE__*/_jsx(Sivupalkki,{}),/*#__PURE__*/_jsx(Typography,{component:Link,to:\"/\",sx:{flexGrow:1,textAlign:'center'},variant:\"h1\",children:\"TicketGuru\"})]})}),/*#__PURE__*/_jsx(Outlet,{}),/*#__PURE__*/_jsxs(Box,{sx:{marginTop:8,display:'flex',flexDirection:'column',alignItems:'center',width:400,marginX:'auto'},children:[/*#__PURE__*/_jsx(Avatar,{sx:{m:1,bgcolor:'secondary.main'},children:/*#__PURE__*/_jsx(LockOutlinedIcon,{})}),/*#__PURE__*/_jsx(Typography,{component:\"h1\",variant:\"h5\",children:\"Sign in\"}),/*#__PURE__*/_jsxs(Box,{component:\"form\",onSubmit:sendLoginRequest,noValidate:true,sx:{mt:1},children:[/*#__PURE__*/_jsx(TextField,{margin:\"normal\",required:true,fullWidth:true,id:\"email\",label:\"Email Address\",name:\"email\",autoComplete:\"email\",autoFocus:true,value:email,onChange:function onChange(e){return setEmail(e.target.value);}}),/*#__PURE__*/_jsx(TextField,{margin:\"normal\",required:true,fullWidth:true,name:\"password\",label:\"Password\",type:\"password\",id:\"password\",autoComplete:\"current-password\",value:password,onChange:function onChange(e){return setPassword(e.target.value);}}),/*#__PURE__*/_jsx(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",sx:{mt:3,mb:2},children:\"Sign In\"})]})]})]})});};export default Login;","map":{"version":3,"names":["useState","useEffect","Box","Typography","AppBar","Toolbar","Container","Sivupalkki","Link","Outlet","useNavigate","Avatar","Button","TextField","LockOutlinedIcon","useUser","jsx","_jsx","jsxs","_jsxs","Login","user","navigate","_useState","_useState2","_slicedToArray","email","setEmail","_useState3","_useState4","password","setPassword","jwt","sendLoginRequest","event","preventDefault","reqBody","fetch","headers","method","body","JSON","stringify","then","response","status","Promise","all","json","reject","_ref","_ref2","setJwt","get","setUserInfo","catch","message","alert","children","component","sx","p","position","borderRadius","to","flexGrow","textAlign","variant","marginTop","display","flexDirection","alignItems","width","marginX","m","bgcolor","onSubmit","noValidate","mt","margin","required","fullWidth","id","label","name","autoComplete","autoFocus","value","onChange","e","target","type","mb"],"sources":["C:/Users/sirvi/Documents/IT-tradenomikoulutus/OhjelmistoProjektiI/TicketGuru/ticketguruclient/src/pages/Login.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { Box, Typography, AppBar, Toolbar, Container } from \"@mui/material\";\r\nimport Sivupalkki from \"../components/Sivupalkki\";\r\nimport { Link, Outlet, useNavigate } from \"react-router-dom\";\r\nimport Avatar from '@mui/material/Avatar';\r\nimport Button from '@mui/material/Button';\r\nimport TextField from '@mui/material/TextField';\r\nimport LockOutlinedIcon from '@mui/icons-material/LockOutlined';\r\nimport { useUser } from '../util/UserProvider';\r\n\r\nconst Login = () => {\r\n  const user = useUser();\r\n  const navigate = useNavigate();\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n\r\n  // Redirect to home page if user is already logged in\r\n  useEffect(() => {\r\n    if (user.jwt) navigate(\"/\");\r\n  }, [user, navigate]);\r\n\r\n  // Send login request\r\n  const sendLoginRequest = (event) => {\r\n    event.preventDefault();\r\n    const reqBody = {\r\n      email: email,\r\n      password: password,\r\n    };\r\n    // Get JWT token from server\r\n    fetch(\"http://localhost:8080/auth/login\", {\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      method: \"POST\",\r\n      body: JSON.stringify(reqBody),\r\n    })\r\n      .then((response) => {\r\n        if (response.status === 200) \r\n          return Promise.all([response.json(), response.headers]);\r\n        else if (response.status === 401 || response.status === 403) {\r\n          return Promise.reject(\"Invalid email or password\");\r\n        } else { \r\n          return Promise.reject(\"Something went wrong\");\r\n        }\r\n      })\r\n      .then(([body, headers]) => {\r\n          // Save JWT token and user info to context\r\n          user.setJwt(headers.get(\"Authorization\"));\r\n          user.setUserInfo(body);\r\n      })\r\n      .catch((message) => {\r\n        alert(message);\r\n      });\r\n  };\r\n  \r\n  return (\r\n    <Container>\r\n    <Box component=\"span\" sx={{p: 2}}>\r\n      <AppBar position='static' sx={{borderRadius: '15px 50px'}}>\r\n        <Toolbar>                 \r\n        {<Sivupalkki />}\r\n            <Typography component={Link} to=\"/\" sx = { {flexGrow:1, textAlign:'center' } }variant=\"h1\">TicketGuru</Typography>\r\n        </Toolbar>\r\n      </AppBar>\r\n      <Outlet/>\r\n      <Box\r\n          sx={{\r\n            marginTop: 8,\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            alignItems: 'center',\r\n            width: 400,\r\n            marginX: 'auto',\r\n          }}\r\n        >\r\n          <Avatar sx={{ m: 1, bgcolor: 'secondary.main' }}>\r\n            <LockOutlinedIcon />\r\n          </Avatar>\r\n          <Typography component=\"h1\" variant=\"h5\">\r\n            Sign in\r\n          </Typography>\r\n          <Box component=\"form\" onSubmit={sendLoginRequest} noValidate sx={{ mt: 1 }}>\r\n            <TextField\r\n              margin=\"normal\"\r\n              required\r\n              fullWidth\r\n              id=\"email\"\r\n              label=\"Email Address\"\r\n              name=\"email\"\r\n              autoComplete=\"email\"\r\n              autoFocus\r\n              value={email}\r\n              onChange={(e) => setEmail(e.target.value)}\r\n            />\r\n            <TextField\r\n              margin=\"normal\"\r\n              required\r\n              fullWidth\r\n              name=\"password\"\r\n              label=\"Password\"\r\n              type=\"password\"\r\n              id=\"password\"\r\n              autoComplete=\"current-password\"\r\n              value={password}\r\n              onChange={(e) => setPassword(e.target.value)}\r\n            />\r\n            <Button\r\n              type=\"submit\"\r\n              fullWidth\r\n              variant=\"contained\"\r\n              sx={{ mt: 3, mb: 2 }}\r\n            >\r\n              Sign In\r\n            </Button>\r\n          </Box>\r\n        </Box>\r\n    </Box>\r\n  </Container>\r\n  )\r\n}\r\n\r\nexport default Login;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}