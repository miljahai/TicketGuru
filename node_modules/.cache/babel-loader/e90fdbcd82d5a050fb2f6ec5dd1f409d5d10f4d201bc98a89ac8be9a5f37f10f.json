{"ast":null,"code":"import _slicedToArray from\"C:/Users/sirvi/Documents/IT-tradenomikoulutus/OhjelmistoProjektiI/TicketGuru/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Box,Button,Card,CardContent,CardHeader,Typography}from\"@mui/material\";import axios from\"axios\";import DeleteIcon from'@mui/icons-material/Delete';import{useEffect,useState}from\"react\";import{useUser}from'../util/UserProvider';import jwt_decode from\"jwt-decode\";import UpdateUser from\"./UpdateUser\";// AppUsers component for listing and deleting users\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function AppUser(props){var user=useUser();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),roles=_useState2[0],setRoles=_useState2[1];// Get user roles from JWT\nuseEffect(function(){if(user&&user.jwt){var decodedJwt=jwt_decode(user.jwt);setRoles(decodedJwt.authorities);}},[user,user.jwt]);// Delete user\nvar deleteUser=function deleteUser(e,userId){e.preventDefault();axios.delete(\"http://localhost:8080/users/\".concat(userId),{headers:{'Authorization':\"Bearer \".concat(user.jwt)}}).then(function(response){console.log(response);// Refresh page\nwindow.location.reload();}).catch(function(error){console.error(error);});};return/*#__PURE__*/_jsx(Box,{children:props.users.map(function(user){return/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardHeader,{title:user.firstname+\" \"+user.lastname}),/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsxs(Typography,{children:[\"Email: \",user.email]}),/*#__PURE__*/_jsxs(Typography,{children:[\"Rooli: \",user.userrole]})]}),roles&&roles.filter(function(role){return role===\"ADMIN\";}).length>0?/*#__PURE__*/_jsxs(Box,{children:[roles&&roles.filter(function(role){return role===\"ADMIN\";}).length>0?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(UpdateUser,{user:user})}):/*#__PURE__*/_jsx(_Fragment,{}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(e){return deleteUser(e,user.appuser_id);},color:\"secondary\",variant:\"contained\",startIcon:/*#__PURE__*/_jsx(DeleteIcon,{}),children:\"Poista\"})]}):/*#__PURE__*/_jsx(_Fragment,{})]},user.appuser_id);})});}export default AppUser;","map":{"version":3,"names":["Box","Button","Card","CardContent","CardHeader","Typography","axios","DeleteIcon","useEffect","useState","useUser","jwt_decode","UpdateUser","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AppUser","props","user","_useState","_useState2","_slicedToArray","roles","setRoles","jwt","decodedJwt","authorities","deleteUser","e","userId","preventDefault","delete","concat","headers","then","response","console","log","window","location","reload","catch","error","children","users","map","title","firstname","lastname","email","userrole","filter","role","length","onClick","appuser_id","color","variant","startIcon"],"sources":["C:/Users/sirvi/Documents/IT-tradenomikoulutus/OhjelmistoProjektiI/TicketGuru/src/components/AppUsers.js"],"sourcesContent":["import { Box, Button, Card, CardContent, CardHeader, Typography } from \"@mui/material\";\r\nimport axios from \"axios\";\r\nimport DeleteIcon from '@mui/icons-material/Delete';\r\nimport { useEffect, useState,  } from \"react\";\r\nimport { useUser } from '../util/UserProvider';\r\nimport jwt_decode from \"jwt-decode\";\r\nimport UpdateUser from \"./UpdateUser\";\r\n\r\n// AppUsers component for listing and deleting users\r\nfunction AppUser(props) {\r\n  const user = useUser();\r\n  const [roles, setRoles] = useState([]);\r\n\r\n  // Get user roles from JWT\r\n  useEffect(() => {\r\n      if (user && user.jwt) {\r\n          const decodedJwt = jwt_decode(user.jwt);\r\n          setRoles(decodedJwt.authorities);\r\n      }\r\n  }, [user, user.jwt]);\r\n\r\n  // Delete user\r\n  const deleteUser = (e, userId) => {\r\n    e.preventDefault();\r\n    axios.delete(`http://localhost:8080/users/${userId}`, {\r\n      headers: {\r\n        'Authorization': `Bearer ${user.jwt}`\r\n      }\r\n    })\r\n      .then(response => {\r\n          console.log(response);\r\n          // Refresh page\r\n          window.location.reload();\r\n      })\r\n      .catch(error => {\r\n          console.error(error);\r\n      });\r\n  }\r\n\r\n  return (\r\n    <Box>\r\n      {props.users.map(user => {\r\n        return (\r\n          <Card key={user.appuser_id}>\r\n            <CardHeader title={user.firstname + \" \" + user.lastname} />\r\n            <CardContent>\r\n                <Typography>Email: {user.email}</Typography>\r\n                <Typography>Rooli: {user.userrole}</Typography>\r\n            </CardContent>\r\n            {roles && roles.filter((role) => role === \"ADMIN\").length > 0 ? (\r\n            <Box>\r\n                {roles && roles.filter((role) => role === \"ADMIN\").length > 0 ? (\r\n              <>\r\n                <UpdateUser user={user}/>\r\n              </>\r\n              ) : (\r\n              <></>\r\n              )}\r\n              <Button onClick={(e) => deleteUser(e, user.appuser_id)} color=\"secondary\" variant=\"contained\" startIcon={<DeleteIcon />}>Poista</Button>\r\n            </Box>\r\n            ) : (\r\n              <></>\r\n            )}\r\n          </Card>\r\n        )\r\n      })}\r\n    </Box>\r\n  )\r\n}\r\n\r\nexport default AppUser;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}