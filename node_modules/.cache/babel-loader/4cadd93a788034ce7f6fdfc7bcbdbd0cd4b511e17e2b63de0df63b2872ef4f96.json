{"ast":null,"code":"import _defineProperty from\"C:/Users/sirvi/Documents/IT-tradenomikoulutus/OhjelmistoProjektiI/TicketGuru/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/sirvi/Documents/IT-tradenomikoulutus/OhjelmistoProjektiI/TicketGuru/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/sirvi/Documents/IT-tradenomikoulutus/OhjelmistoProjektiI/TicketGuru/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Button,Dialog,DialogTitle,DialogActions,DialogContent,TextField,Autocomplete}from'@mui/material';import axios from\"axios\";import{useEffect,useState}from\"react\";import{useUser}from'../util/UserProvider';import EditIcon from'@mui/icons-material/Edit';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function UpdateUser(props){var user=useUser();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),userRoles=_useState2[0],setUserRoles=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),selectedRole=_useState4[0],setSelectedRole=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),open=_useState6[0],setOpen=_useState6[1];var _useState7=useState({firstname:props.user.firstname,lastname:props.user.lastname,email:props.user.email,userrole:props.user.userrole}),_useState8=_slicedToArray(_useState7,2),updatedUser=_useState8[0],setUpdatedUser=_useState8[1];// Open Dialog\nvar handleClickOpen=function handleClickOpen(){setOpen(true);};// Close Dialog\nvar handleClose=function handleClose(){setUpdatedUser({});setOpen(false);};// Fetch user roles for Dialog userrole selection\nuseEffect(function(){Promise.all([axios.get('http://localhost:8080/roles',{headers:{'Authorization':\"Bearer \".concat(user.jwt)}})]).then(function(_ref){var _ref2=_slicedToArray(_ref,1),response=_ref2[0];setUserRoles(response.data);}).catch(function(error){console.log('Error fetching roles: ',error);});},[user.jwt]);// Handle input changes\nvar handleInputChange=function handleInputChange(e){setUpdatedUser(_objectSpread(_objectSpread({},updatedUser),{},_defineProperty({},e.target.name,e.target.value)));};// Update user\nvar handleSubmit=function handleSubmit(e){e.preventDefault();console.log(updatedUser);axios.put(\"http://localhost:8080/users/\".concat(props.user.appuser_id),updatedUser,{headers:{'Authorization':\"Bearer \".concat(user.jwt)}}).then(function(response){console.log(response);alert('User updated successfully!');//  refresh page\nwindow.location.reload();handleClose();}).catch(function(error){console.error(error);alert('Error updating user!');});};return/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(Button,{variant:\"contained\",sx:{m:1},onClick:handleClickOpen,children:[/*#__PURE__*/_jsx(EditIcon,{}),\"Muokkaa\"]}),/*#__PURE__*/_jsxs(Dialog,{open:open,onClose:handleClose,children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Muokkaa k\\xE4ytt\\xE4j\\xE4\\xE4\"}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsx(TextField,{margin:\"dense\",name:\"firstname\",value:updatedUser.firstname,label:\"Etunimi\",onChange:function onChange(e,newValue){return handleInputChange(e);},fullWidth:true,variant:\"standard\",required:true}),/*#__PURE__*/_jsx(TextField,{margin:\"dense\",name:\"lastname\",value:updatedUser.lastname,label:\"Sukunimi\",onChange:function onChange(e){return handleInputChange(e);},fullWidth:true,variant:\"standard\",required:true}),/*#__PURE__*/_jsx(TextField,{margin:\"dense\",name:\"email\",value:updatedUser.email,label:\"Email\",onChange:function onChange(e){return handleInputChange(e);},fullWidth:true,variant:\"standard\",required:true}),/*#__PURE__*/_jsx(Autocomplete,{sx:{margin:'dense'},options:Object.values(userRoles).map(function(userRoles){return userRoles;}),getOptionLabel:function getOptionLabel(option){return option||'';},renderInput:function renderInput(params){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{label:\"Rooli\"}));},value:selectedRole,defaultValue:null,freeSolo:true,name:\"userrole\",onChange:function onChange(event,value){setSelectedRole(value);setUpdatedUser(_objectSpread(_objectSpread({},updatedUser),{},{userrole:value}));}})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:handleSubmit,children:\"Tallenna\"}),/*#__PURE__*/_jsx(Button,{onClick:handleClose,children:\"Peruuta\"})]})]})]});}export default UpdateUser;","map":{"version":3,"names":["Button","Dialog","DialogTitle","DialogActions","DialogContent","TextField","Autocomplete","axios","useEffect","useState","useUser","EditIcon","jsx","_jsx","jsxs","_jsxs","UpdateUser","props","user","_useState","_useState2","_slicedToArray","userRoles","setUserRoles","_useState3","_useState4","selectedRole","setSelectedRole","_useState5","_useState6","open","setOpen","_useState7","firstname","lastname","email","userrole","_useState8","updatedUser","setUpdatedUser","handleClickOpen","handleClose","Promise","all","get","headers","concat","jwt","then","_ref","_ref2","response","data","catch","error","console","log","handleInputChange","e","_objectSpread","_defineProperty","target","name","value","handleSubmit","preventDefault","put","appuser_id","alert","window","location","reload","children","variant","sx","m","onClick","onClose","margin","label","onChange","newValue","fullWidth","required","options","Object","values","map","getOptionLabel","option","renderInput","params","defaultValue","freeSolo","event"],"sources":["C:/Users/sirvi/Documents/IT-tradenomikoulutus/OhjelmistoProjektiI/TicketGuru/src/components/UpdateUser.js"],"sourcesContent":["import { Button, Dialog, DialogTitle, DialogActions, DialogContent, TextField, Autocomplete } from '@mui/material'\r\nimport axios from \"axios\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useUser } from '../util/UserProvider';\r\nimport EditIcon from '@mui/icons-material/Edit';\r\n\r\nfunction UpdateUser(props) {\r\n  const user = useUser();\r\n  const [userRoles, setUserRoles] = useState([]);\r\n  const [selectedRole, setSelectedRole] = useState('');\r\n  const [open, setOpen] = useState(false);\r\n  const [updatedUser, setUpdatedUser] = useState({\r\n    firstname: props.user.firstname,\r\n    lastname: props.user.lastname,\r\n    email: props.user.email,\r\n    userrole: props.user.userrole\r\n  });\r\n\r\n  // Open Dialog\r\n  const handleClickOpen = () => {\r\n    setOpen(true);\r\n  };\r\n  // Close Dialog\r\n  const handleClose = () => {\r\n    setUpdatedUser({})\r\n    setOpen(false);\r\n  };\r\n\r\n  // Fetch user roles for Dialog userrole selection\r\n  useEffect(() => {\r\n    Promise.all([\r\n        axios.get('http://localhost:8080/roles', {\r\n            headers: {\r\n                'Authorization': `Bearer ${user.jwt}`\r\n            }\r\n        })\r\n    ]).then(([response]) => {\r\n        setUserRoles(response.data);\r\n    }).catch(error => {\r\n        console.log('Error fetching roles: ', error);\r\n    });\r\n}, [user.jwt]);\r\n\r\n  // Handle input changes\r\n  const handleInputChange = (e) => {\r\n    setUpdatedUser({\r\n      ...updatedUser,\r\n      [e.target.name]: e.target.value\r\n    });\r\n  };\r\n  \r\n  // Update user\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    console.log(updatedUser);\r\n    axios.put(`http://localhost:8080/users/${props.user.appuser_id}`, updatedUser, {\r\n        headers: {\r\n            'Authorization': `Bearer ${user.jwt}`\r\n        }\r\n    })\r\n    .then(response => {\r\n      console.log(response);\r\n      alert('User updated successfully!');\r\n      //  refresh page\r\n      window.location.reload();\r\n      handleClose();\r\n    })\r\n    .catch(error => {\r\n      console.error(error);\r\n      alert('Error updating user!');\r\n    });\r\n  };\r\n\r\n  return (\r\n    <span>\r\n      <Button variant=\"contained\" sx={{ m: 1 }} onClick={handleClickOpen}>\r\n        <EditIcon />Muokkaa\r\n      </Button>\r\n      <Dialog open={open} onClose={handleClose}>\r\n        <DialogTitle>Muokkaa k채ytt채j채채</DialogTitle>\r\n        <DialogContent>\r\n          <TextField\r\n              margin='dense'\r\n              name='firstname'\r\n              value={updatedUser.firstname}\r\n              label='Etunimi'\r\n              onChange={(e, newValue) => handleInputChange(e)}\r\n              fullWidth\r\n              variant='standard'\r\n              required\r\n          />\r\n          <TextField\r\n              margin='dense'\r\n              name='lastname'\r\n              value={updatedUser.lastname}\r\n              label='Sukunimi'\r\n              onChange={e => handleInputChange(e)}\r\n              fullWidth\r\n              variant='standard'\r\n              required\r\n          />\r\n          <TextField\r\n              margin='dense'\r\n              name='email'\r\n              value={updatedUser.email}\r\n              label='Email'\r\n              onChange={e => handleInputChange(e)}\r\n              fullWidth\r\n              variant='standard'\r\n              required\r\n          />\r\n          <Autocomplete\r\n              sx={{ margin: 'dense' }}\r\n              options={Object.values(userRoles).map((userRoles) => userRoles)}\r\n              getOptionLabel={(option) => option || ''}\r\n              renderInput={(params) => <TextField {...params} label=\"Rooli\" />}\r\n              value={selectedRole}\r\n              defaultValue={null}\r\n              freeSolo={true}\r\n              name='userrole'\r\n              onChange={(event, value) => {\r\n                  setSelectedRole(value);\r\n                  setUpdatedUser({ ...updatedUser, userrole: value });\r\n              }}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n            <Button onClick={handleSubmit}>Tallenna</Button>\r\n            <Button onClick={handleClose}>Peruuta</Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </span>\r\n  );\r\n} \r\n\r\nexport default UpdateUser;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}