{"ast":null,"code":"import _slicedToArray from\"C:/Users/sirvi/Documents/IT-tradenomikoulutus/OhjelmistoProjektiI/TicketGuru/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Box,Typography,AppBar,Toolbar,Container,Button}from\"@mui/material\";import Sivupalkki from\"../components/Sivupalkki\";import{Link}from\"react-router-dom\";import{useEffect,useState}from\"react\";import axios from\"axios\";import TicketTypesGrid from\"../components/TicketTypesGrid\";import{useUser}from'../util/UserProvider';import EditIcon from'@mui/icons-material/Edit';import AddIcon from'@mui/icons-material/Add';import ArticleIcon from'@mui/icons-material/Article';import AddTicketTypes from'../components/AddTicketTypes';import jwt_decode from\"jwt-decode\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Lipputyypit(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),tickettypes=_useState2[0],setTickettypes=_useState2[1];var user=useUser();var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),roles=_useState4[0],setRoles=_useState4[1];useEffect(function(){if(user&&user.jwt){var decodedJwt=jwt_decode(user.jwt);setRoles(decodedJwt.authorities);}},[user,user.jwt]);useEffect(function(){Promise.all([axios.get('http://localhost:8080/tickettypes',{headers:{'Authorization':\"Bearer \".concat(user.jwt)}})]).then(function(_ref){var _ref2=_slicedToArray(_ref,1),tickettypesResponse=_ref2[0];console.log('TicketTypes fetched:',tickettypesResponse.data);var ttdata=tickettypesResponse.data.filter(function(tt){return tt.eventRecord!=null;});setTickettypes(ttdata);}).catch(function(error){console.log('Error fetching TicketTypes: ',error);});},[user.jwt]);var saveTickettype=function saveTickettype(tickettype){// Save a new tickettype\nPromise.all([axios.post(\"http://localhost:8080/tickettypes\",tickettype,{headers:{'Authorization':\"Bearer \".concat(user.jwt)}})]).then(function(response){console.log('TicketType created: ',response[0].data);console.log('refreshing grid');// Get updated data from server\n// Refresh grid with new data\naxios.get('http://localhost:8080/tickettypes',{headers:{'Authorization':\"Bearer \".concat(user.jwt)}}).then(function(tickettypesResponse){console.log('TicketTypes fetched:',tickettypesResponse.data);var ttdata=tickettypesResponse.data.filter(function(tt){return tt.eventRecord!=null;});setTickettypes(ttdata);}).catch(function(error){console.log('Error fetching TicketTypes: ',error);});}).catch(function(error){console.log('Error creating TicketType: ',error);});};return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsxs(Box,{component:\"span\",sx:{p:2},children:[/*#__PURE__*/_jsx(AppBar,{position:\"static\",sx:{borderRadius:'15px 50px'},children:/*#__PURE__*/_jsxs(Toolbar,{children:[/*#__PURE__*/_jsx(Sivupalkki,{}),/*#__PURE__*/_jsx(Typography,{component:Link,to:\"/\",sx:{flexGrow:1,textAlign:'center'},variant:\"h1\",children:\"TicketGuru\"})]})}),/*#__PURE__*/_jsx(Typography,{variant:\"h2\",sx:{flexGrow:1,textAlign:'center'},children:\"Lipputyypit\"}),/*#__PURE__*/_jsx(Button,{component:Link,to:\"../tapahtumat\",endIcon:/*#__PURE__*/_jsx(ArticleIcon,{}),color:\"primary\",children:\"Tapahtumat\"}),roles&&roles.filter(function(role){return role===\"ADMIN\"||role===\"EVENTS\";}).length>0?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Button,{component:Link,to:\"../tapahtumanlisays\",endIcon:/*#__PURE__*/_jsx(AddIcon,{}),children:\"Lis\\xE4\\xE4 tapahtuma\"})}):/*#__PURE__*/_jsx(_Fragment,{}),/*#__PURE__*/_jsx(Button,{component:Link,to:\"../lipputyypit\",endIcon:/*#__PURE__*/_jsx(EditIcon,{}),variant:\"outlined\",children:\"Lipputyypit\"})]}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{p:0,textAlign:'left'},children:roles&&roles.filter(function(role){return role===\"ADMIN\"||role===\"EVENTS\";}).length>0?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(AddTicketTypes,{saveTickettype:saveTickettype,user:user})}):/*#__PURE__*/_jsx(_Fragment,{})}),/*#__PURE__*/_jsx(Box,{children:/*#__PURE__*/_jsx(TicketTypesGrid,{tickettypes:tickettypes,user:user})})]});}","map":{"version":3,"names":["Box","Typography","AppBar","Toolbar","Container","Button","Sivupalkki","Link","useEffect","useState","axios","TicketTypesGrid","useUser","EditIcon","AddIcon","ArticleIcon","AddTicketTypes","jwt_decode","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Lipputyypit","_useState","_useState2","_slicedToArray","tickettypes","setTickettypes","user","_useState3","_useState4","roles","setRoles","jwt","decodedJwt","authorities","Promise","all","get","headers","concat","then","_ref","_ref2","tickettypesResponse","console","log","data","ttdata","filter","tt","eventRecord","catch","error","saveTickettype","tickettype","post","response","children","component","sx","p","position","borderRadius","to","flexGrow","textAlign","variant","endIcon","color","role","length"],"sources":["C:/Users/sirvi/Documents/IT-tradenomikoulutus/OhjelmistoProjektiI/TicketGuru/src/pages/Lipputyypit.js"],"sourcesContent":["import { Box, Typography, AppBar, Toolbar, Container, Button } from \"@mui/material\";\r\nimport Sivupalkki from \"../components/Sivupalkki\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport TicketTypesGrid from \"../components/TicketTypesGrid\";\r\nimport { useUser } from '../util/UserProvider';\r\nimport EditIcon from '@mui/icons-material/Edit';\r\nimport AddIcon from '@mui/icons-material/Add';\r\nimport ArticleIcon from '@mui/icons-material/Article';\r\nimport AddTicketTypes from '../components/AddTicketTypes';\r\nimport jwt_decode from \"jwt-decode\";\r\n\r\nexport default function Lipputyypit() {\r\n\r\n    const [tickettypes, setTickettypes] = useState([]);\r\n    const user = useUser();\r\n    const [roles, setRoles] = useState([]);\r\n\r\n    useEffect(() => {\r\n        if (user && user.jwt) {\r\n            const decodedJwt = jwt_decode(user.jwt);\r\n            setRoles(decodedJwt.authorities);\r\n        }\r\n    }, [user, user.jwt]);\r\n\r\n    useEffect(() => {\r\n        Promise.all([\r\n            axios.get('http://localhost:8080/tickettypes', {\r\n                headers: {\r\n                    'Authorization': `Bearer ${user.jwt}`\r\n                }\r\n            })\r\n        ]).then(([tickettypesResponse]) => {\r\n            console.log('TicketTypes fetched:', tickettypesResponse.data);\r\n            const ttdata = tickettypesResponse.data.filter(tt => tt.eventRecord != null)\r\n            setTickettypes(ttdata);\r\n        }).catch(error => {\r\n            console.log('Error fetching TicketTypes: ', error);\r\n        });\r\n    }, [user.jwt]);\r\n\r\n    const saveTickettype = (tickettype) => {\r\n        // Save a new tickettype\r\n        Promise.all([\r\n            axios.post(\r\n                `http://localhost:8080/tickettypes`,\r\n                tickettype,\r\n                {\r\n                    headers: {\r\n                        'Authorization': `Bearer ${user.jwt}`\r\n                    }\r\n                })\r\n        ]).then((response) => {\r\n            console.log('TicketType created: ', response[0].data);\r\n\r\n            console.log('refreshing grid')\r\n            // Get updated data from server\r\n            // Refresh grid with new data\r\n            axios.get('http://localhost:8080/tickettypes', {\r\n                headers: {\r\n                    'Authorization': `Bearer ${user.jwt}`\r\n                }\r\n            }).then((tickettypesResponse) => {\r\n                console.log('TicketTypes fetched:', tickettypesResponse.data);\r\n                const ttdata = tickettypesResponse.data.filter(tt => tt.eventRecord != null)\r\n                setTickettypes(ttdata);\r\n            }).catch(error => {\r\n                console.log('Error fetching TicketTypes: ', error);\r\n            });\r\n        }).catch(error => {\r\n            console.log('Error creating TicketType: ', error)\r\n        });\r\n    };\r\n\r\n\r\n    return (\r\n        <Container>\r\n            <Box component=\"span\" sx={{ p: 2 }}>\r\n\r\n                <AppBar position='static' sx={{ borderRadius: '15px 50px' }}>\r\n                    <Toolbar>\r\n                        {<Sivupalkki />}\r\n                        <Typography component={Link} to=\"/\" sx={{ flexGrow: 1, textAlign: 'center' }} variant=\"h1\">TicketGuru</Typography>\r\n                    </Toolbar>\r\n                </AppBar>\r\n\r\n                <Typography variant=\"h2\" sx={{ flexGrow: 1, textAlign: 'center' }}>Lipputyypit</Typography>\r\n                <Button component={Link} to=\"../tapahtumat\" endIcon={<ArticleIcon />} color='primary' >Tapahtumat</Button>\r\n                {roles && roles.filter((role) => role === \"ADMIN\" || role === \"EVENTS\").length > 0 ? (\r\n                    <>\r\n                        <Button component={Link} to=\"../tapahtumanlisays\" endIcon={<AddIcon />} >Lisää tapahtuma</Button>\r\n                    </>\r\n                ) : (\r\n                    <></>\r\n                )}\r\n                <Button component={Link} to='../lipputyypit' endIcon={<EditIcon />} variant='outlined' >Lipputyypit</Button>\r\n            </Box>\r\n            <Typography variant='body2' sx={{ p: 0, textAlign: 'left' }}>\r\n                {roles && roles.filter((role) => role === \"ADMIN\" || role === \"EVENTS\").length > 0 ? (\r\n                    <>\r\n                        <AddTicketTypes saveTickettype={saveTickettype} user={user} />\r\n                    </>\r\n                ) : (\r\n                    <></>\r\n                )}\r\n            </Typography>\r\n            <Box>\r\n                <TicketTypesGrid tickettypes={tickettypes} user={user} />\r\n            </Box>\r\n\r\n        </Container >\r\n    )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}